<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='en' xml:lang='en' xmlns='http://www.w3.org/1999/xhtml'>
  <head>
    <title>/Users/kaz/Projects/GSoC/bioruby/lib/bio/location.rb</title>
    <link href="screen.css" media="all" rel="stylesheet" type="text/css" />
    <link href="print.css" media="print" rel="stylesheet" type="text/css" />
    
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8" />
    <script type="text/javascript" src="rcov.js"></script>
  </head>
  <body>
    <h1>Bio C0 Coverage Information - RCov</h1>
    <h2>/Users/kaz/Projects/GSoC/bioruby/lib/bio/location.rb</h2>

    

    <div class="report_table_wrapper">
      <table class='report' id='report_table'>
        <thead>
          <tr>
            <th class="left_align">Name</th>
            <th class="right_align">Total Lines</th>
            <th class="right_align">Lines of Code</th>
            <th class="left_align">Total Coverage</th>
            <th class="left_align">Code Coverage</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="left_align"><a href="-Users-kaz-Projects-GSoC-bioruby-lib-bio-location_rb.html">/Users/kaz/Projects/GSoC/bioruby/lib/bio/location.rb</a></td>
            <td class='right_align'><tt>833</tt></td>
            <td class='right_align'><tt>352</tt></td>
            <td class="left_align"><div class="percent_graph_legend"><tt class=''>88.60%</tt></div>
          <div class="percent_graph">
            <div class="covered" style="width:89px"></div>
            <div class="uncovered" style="width:11px"></div>
          </div></td>
            <td class="left_align"><div class="percent_graph_legend"><tt class=''>74.15%</tt></div>
          <div class="percent_graph">
            <div class="covered" style="width:74px"></div>
            <div class="uncovered" style="width:26px"></div>
          </div></td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <h3>Key</h3>
    
    <div class="key"><pre><span class='marked'>Code reported as executed by Ruby looks like this...</span><span class='marked1'>and this: this line is also marked as covered.</span><span class='inferred'>Lines considered as run by rcov, but not reported by Ruby, look like this,</span><span class='inferred1'>and this: these lines were inferred by rcov (using simple heuristics).</span><span class='uncovered'>Finally, here's a line marked as not executed.</span></pre></div>

    <h3>Coverage Details</h3>

    <table class="details">
      <tbody>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line1">1</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line2">2</a> # = bio/location.rb - Locations/Location class (GenBank location format)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line3">3</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line4">4</a> # Copyright::	Copyright (C) 2001, 2005 Toshiaki Katayama &lt;k@bioruby.org&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line5">5</a> #                             2006       Jan Aerts &lt;jan.aerts@bbsrc.ac.uk&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line6">6</a> #                             2008       Naohisa Goto &lt;ng@bioruby.org&gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line7">7</a> # License::	The Ruby License</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line8">8</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line9">9</a> # $Id:$</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line10">10</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line11">11</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line12">12</a> module Bio</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line13">13</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line14">14</a> # == Description</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line15">15</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line16">16</a> # The Bio::Location class describes the position of a genomic locus.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line17">17</a> # Typically, Bio::Location objects are created automatically when the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line18">18</a> # user creates a Bio::Locations object, instead of initialized directly.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line19">19</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line20">20</a> # == Usage</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line21">21</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line22">22</a> #   location = Bio::Location.new('500..550')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line23">23</a> #   puts &quot;start=&quot; + location.from.to_s + &quot;;end=&quot; + location.to.to_s</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line24">24</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line25">25</a> #   #, or better: through Bio::Locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line26">26</a> #   locations = Bio::Locations.new('500..550')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line27">27</a> #   locations.each do |location|</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line28">28</a> #     puts &quot;start=&quot; + location.from.to_s + &quot;;end=&quot; + location.to.to_s</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line29">29</a> #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line30">30</a> #</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line31">31</a> class Location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line32">32</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line33">33</a>   include Comparable</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line34">34</a> 	</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line35">35</a>   # Parses a'location' segment, which can be 'ID:' + ('n' or 'n..m' or 'n^m'</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line36">36</a>   # or &quot;seq&quot;) with '&lt;' or '&gt;', and returns a Bio::Location object.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line37">37</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line38">38</a>   #   location = Bio::Location.new('500..550')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line39">39</a>   # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line40">40</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line41">41</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line42">42</a>   # * (required) _str_: GenBank style position string (see Bio::Locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line43">43</a>   #   documentation)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line44">44</a>   # *Returns*:: the Bio::Location object</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line45">45</a>   def initialize(location = nil)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line46">46</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line47">47</a>     if location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line48">48</a>       if location =~ /:/				# (G) ID:location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line49">49</a>         xref_id, location = location.split(':')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line50">50</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line51">51</a>       if location =~ /&lt;/				# (I) &lt;,&gt;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line52">52</a>         lt = true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line53">53</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line54">54</a>       if location =~ /&gt;/</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line55">55</a>         gt = true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line56">56</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line57">57</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line58">58</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line59">59</a>     # s : start base, e : end base =&gt; from, to</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line60">60</a>     case location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line61">61</a>     when /^[&lt;&gt;]?(\d+)$/					# (A, I) n</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line62">62</a>       s = e = $1.to_i</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line63">63</a>     when /^[&lt;&gt;]?(\d+)\.\.[&lt;&gt;]?(\d+)$/			# (B, I) n..m</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line64">64</a>       s = $1.to_i</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line65">65</a>       e = $2.to_i</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line66">66</a>       if e - s &lt; 0</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line67">67</a> #       raise &quot;Error: invalid range : #{location}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line68">68</a>         $stderr.puts &quot;[Warning] invalid range : #{location}&quot; if $DEBUG</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line69">69</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line70">70</a>     when /^[&lt;&gt;]?(\d+)\^[&lt;&gt;]?(\d+)$/			# (C, I) n^m</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line71">71</a>       s = $1.to_i</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line72">72</a>       e = $2.to_i</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line73">73</a>       carat = true</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line74">74</a>       if e - s != 1 or e != 1 # assert n^n+1 or n^1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line75">75</a> #       raise &quot;Error: invalid range : #{location}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line76">76</a>         $stderr.puts &quot;[Warning] invalid range : #{location}&quot; if $DEBUG</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line77">77</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line78">78</a>     when /^&quot;?([ATGCatgc]+)&quot;?$/                  # (H) literal sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line79">79</a>       sequence = $1.downcase</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line80">80</a>       s = e = nil</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line81">81</a>     when nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line82">82</a>       ;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line83">83</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line84">84</a>       raise &quot;Error: unknown location format : #{location}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line85">85</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line86">86</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line87">87</a>     @from       = s             # start position of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line88">88</a>     @to         = e             # end position of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line89">89</a>     @strand     = 1             # strand direction of the location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line90">90</a>                                 #   forward =&gt; 1 or complement =&gt; -1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line91">91</a>     @sequence   = sequence      # literal sequence of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line92">92</a>     @lt         = lt            # true if the position contains '&lt;'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line93">93</a>     @gt         = gt            # true if the position contains '&gt;'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line94">94</a>     @xref_id    = xref_id       # link to the external entry as GenBank ID</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line95">95</a>     @carat      = carat         # true if the location indicates the site</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line96">96</a>                                 # between two adjoining nucleotides</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line97">97</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line98">98</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line99">99</a>   # (Integer) start position of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line100">100</a>   attr_accessor :from</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line101">101</a>   # (Integer) end position of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line102">102</a>   attr_accessor :to</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line103">103</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line104">104</a>   # (Integer) strand direction of the location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line105">105</a>   # (forward =&gt; 1 or complement =&gt; -1)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line106">106</a>   attr_accessor :strand</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line107">107</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line108">108</a>   # (String) literal sequence of the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line109">109</a>   attr_accessor :sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line110">110</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line111">111</a>   # (true, false or nil) true if the position contains '&lt;'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line112">112</a>   attr_accessor :lt</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line113">113</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line114">114</a>   # (true, false or nil) true if the position contains '&gt;'</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line115">115</a>   attr_accessor :gt</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line116">116</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line117">117</a>   # (String) link to the external entry as GenBank ID</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line118">118</a>   attr_accessor :xref_id</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line119">119</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line120">120</a>   # (true, false or nil) true if the location indicates the site</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line121">121</a>   # between two adjoining nucleotides</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line122">122</a>   attr_accessor :carat</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line123">123</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line124">124</a>   # Complements the sequence location (i.e. alternates the strand).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line125">125</a>   # Note that it is destructive method (i.e. modifies itself),</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line126">126</a>   # but it does not modify the &quot;sequence&quot; attribute.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line127">127</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line128">128</a>   # *Returns*:: the Bio::Location object</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line129">129</a>   def complement</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line130">130</a>     @strand *= -1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line131">131</a>     self					# return Location object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line132">132</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line133">133</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line134">134</a>   # Replaces the sequence of the location.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line135">135</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line136">136</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line137">137</a>   # * (required) _sequence_: sequence to be used to replace the sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line138">138</a>   #   at the location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line139">139</a>   # *Returns*:: the Bio::Location object</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line140">140</a>   def replace(sequence)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line141">141</a>     @sequence = sequence.downcase</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line142">142</a>     self					# return Location object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line143">143</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line144">144</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line145">145</a>   # Returns the range (from..to) of the location as a Range object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line146">146</a>   def range</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line147">147</a>     @from..@to</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line148">148</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line149">149</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line150">150</a>   # Check where a Bio::Location object is located compared to another</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line151">151</a>   # Bio::Location object (mainly to facilitate the use of Comparable).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line152">152</a>   # A location A is upstream of location B if the start position of</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line153">153</a>   # location A is smaller than the start position of location B. If</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line154">154</a>   # they're the same, the end positions are checked.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line155">155</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line156">156</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line157">157</a>   # * (required) _other location_: a Bio::Location object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line158">158</a>   # *Returns*::</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line159">159</a>   # * 1 if self &lt; other location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line160">160</a>   # * -1 if self &gt; other location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line161">161</a>   # * 0 if both location are the same</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line162">162</a>   # * nil if the argument is not a Bio::Location object</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line163">163</a>   def &lt;=&gt;(other)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line164">164</a>     if ! other.kind_of?(Bio::Location)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line165">165</a>       return nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line166">166</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line167">167</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line168">168</a>     if @from.to_f &lt; other.from.to_f</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line169">169</a>       return -1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line170">170</a>     elsif @from.to_f &gt; other.from.to_f</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line171">171</a>       return 1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line172">172</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line173">173</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line174">174</a>     if @to.to_f &lt; other.to.to_f</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line175">175</a>       return -1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line176">176</a>     elsif @to.to_f &gt; other.to.to_f</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line177">177</a>       return 1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line178">178</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line179">179</a>     return 0</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line180">180</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line181">181</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line182">182</a>   # If _other_ is equal with the self, returns true.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line183">183</a>   # Otherwise, returns false.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line184">184</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line185">185</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line186">186</a>   # * (required) _other_: any object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line187">187</a>   # *Returns*:: true or false</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line188">188</a>   def ==(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line189">189</a>     return true if super(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line190">190</a>     return false unless other.instance_of?(self.class)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line191">191</a>     flag = false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line192">192</a>     [ :from, :to, :strand, :sequence, :lt, :gt,</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line193">193</a>       :xref_id, :carat ].each do |m|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line194">194</a>       begin</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line195">195</a>         flag = (self.__send__(m) == other.__send__(m))</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line196">196</a>       rescue NoMethodError, ArgumentError, NameError</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line197">197</a>         flag = false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line198">198</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line199">199</a>       break unless flag</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line200">200</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line201">201</a>     flag</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line202">202</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line203">203</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line204">204</a> end # Location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line205">205</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line206">206</a> # == Description</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line207">207</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line208">208</a> # The Bio::Locations class is a container for Bio::Location objects:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line209">209</a> # creating a Bio::Locations object (based on a GenBank style position string)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line210">210</a> # will spawn an array of Bio::Location objects.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line211">211</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line212">212</a> # == Usage</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line213">213</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line214">214</a> #   locations = Bio::Locations.new('join(complement(500..550), 600..625)')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line215">215</a> #   locations.each do |loc|</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line216">216</a> #     puts &quot;class = &quot; + loc.class.to_s</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line217">217</a> #     puts &quot;range = #{loc.from}..#{loc.to} (strand = #{loc.strand})&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line218">218</a> #   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line219">219</a> #   # Output would be:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line220">220</a> #   #   class = Bio::Location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line221">221</a> #   #   range = 500..550 (strand = -1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line222">222</a> #   #   class = Bio::Location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line223">223</a> #   #   range = 600..625 (strand = 1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line224">224</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line225">225</a> #  # For the following three location strings, print the span and range</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line226">226</a> #  ['one-of(898,900)..983',</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line227">227</a> #   'one-of(5971..6308,5971..6309)',</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line228">228</a> #   '8050..one-of(10731,10758,10905,11242)'].each do |loc|</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line229">229</a> #      location = Bio::Locations.new(loc)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line230">230</a> #      puts location.span</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line231">231</a> #      puts location.range</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line232">232</a> #  end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line233">233</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line234">234</a> # === GenBank location descriptor classification</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line235">235</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line236">236</a> # ==== Definition of the position notation of the GenBank location format</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line237">237</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line238">238</a> # According to the GenBank manual 'gbrel.txt', position notations were</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line239">239</a> # classified into 10 patterns - (A) to (J).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line240">240</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line241">241</a> #   3.4.12.2 Feature Location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line242">242</a> #   </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line243">243</a> #     The second column of the feature descriptor line designates the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line244">244</a> #   location of the feature in the sequence. The location descriptor</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line245">245</a> #   begins at position 22. Several conventions are used to indicate</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line246">246</a> #   sequence location.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line247">247</a> #   </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line248">248</a> #     Base numbers in location descriptors refer to numbering in the entry,</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line249">249</a> #   which is not necessarily the same as the numbering scheme used in the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line250">250</a> #   published report. The first base in the presented sequence is numbered</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line251">251</a> #   base 1. Sequences are presented in the 5 to 3 direction.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line252">252</a> #   </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line253">253</a> #   Location descriptors can be one of the following:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line254">254</a> #       </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line255">255</a> #   (A) 1. A single base;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line256">256</a> #         </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line257">257</a> #   (B) 2. A contiguous span of bases;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line258">258</a> #         </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line259">259</a> #   (C) 3. A site between two bases;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line260">260</a> #         </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line261">261</a> #   (D) 4. A single base chosen from a range of bases;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line262">262</a> #     </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line263">263</a> #   (E) 5. A single base chosen from among two or more specified bases;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line264">264</a> #     </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line265">265</a> #   (F) 6. A joining of sequence spans;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line266">266</a> #     </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line267">267</a> #   (G) 7. A reference to an entry other than the one to which the feature</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line268">268</a> #        belongs (i.e., a remote entry), followed by a location descriptor</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line269">269</a> #        referring to the remote sequence;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line270">270</a> #     </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line271">271</a> #   (H) 8. A literal sequence (a string of bases enclosed in quotation marks).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line272">272</a> #   </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line273">273</a> # ==== Description commented with pattern IDs.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line274">274</a> #  </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line275">275</a> #   (C)   A site between two residues, such as an endonuclease cleavage site, is</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line276">276</a> #       indicated by listing the two bases separated by a carat (e.g., 23^24).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line277">277</a> #     </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line278">278</a> #   (D)   A single residue chosen from a range of residues is indicated by the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line279">279</a> #       number of the first and last bases in the range separated by a single</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line280">280</a> #       period (e.g., 23.79). The symbols &lt; and &gt; indicate that the end point</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line281">281</a> #   (I) of the range is beyond the specified base number.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line282">282</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line283">283</a> #   (B)   A contiguous span of bases is indicated by the number of the first and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line284">284</a> #       last bases in the range separated by two periods (e.g., 23..79). The</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line285">285</a> #   (I) symbols &lt; and &gt; indicate that the end point of the range is beyond the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line286">286</a> #       specified base number. Starting and ending positions can be indicated</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line287">287</a> #       by base number or by one of the operators described below.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line288">288</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line289">289</a> #         Operators are prefixes that specify what must be done to the indicated</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line290">290</a> #       sequence to locate the feature. The following are the operators</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line291">291</a> #       available, along with their most common format and a description.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line292">292</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line293">293</a> #   (J) complement (location): The feature is complementary to the location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line294">294</a> #       indicated. Complementary strands are read 5 to 3.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line295">295</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line296">296</a> #   (F) join (location, location, .. location): The indicated elements should</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line297">297</a> #       be placed end to end to form one contiguous sequence.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line298">298</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line299">299</a> #   (F) order (location, location, .. location): The elements are found in the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line300">300</a> #       specified order in the 5 to 3 direction, but nothing is implied about</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line301">301</a> #       the rationality of joining them.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line302">302</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line303">303</a> #   (F) group (location, location, .. location): The elements are related and</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line304">304</a> #       should be grouped together, but no order is implied.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line305">305</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line306">306</a> #   (E) one-of (location, location, .. location): The element can be any one,</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line307">307</a> #     but only one, of the items listed.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line308">308</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line309">309</a> # === Reduction strategy of the position notations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line310">310</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line311">311</a> # * (A) Location n</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line312">312</a> # * (B) Location n..m</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line313">313</a> # * (C) Location n^m</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line314">314</a> # * (D) (n.m)			=&gt; Location n</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line315">315</a> # * (E)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line316">316</a> #   * one-of(n,m,..)		=&gt; Location n</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line317">317</a> #   * one-of(n..m,..)		=&gt; Location n..m</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line318">318</a> # * (F)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line319">319</a> #   * order(loc,loc,..)		=&gt; join(loc, loc,..)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line320">320</a> #   * group(loc,loc,..)		=&gt; join(loc, loc,..)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line321">321</a> #   * join(loc,loc,..)		=&gt; Sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line322">322</a> # * (G) ID:loc			=&gt; Location with ID</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line323">323</a> # * (H) &quot;atgc&quot;			=&gt; Location only with Sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line324">324</a> # * (I)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line325">325</a> #   * &lt;n			=&gt; Location n with lt flag</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line326">326</a> #   * &gt;n			=&gt; Location n with gt flag</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line327">327</a> #   * &lt;n..m			=&gt; Location n..m with lt flag</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line328">328</a> #   * n..&gt;m			=&gt; Location n..m with gt flag</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line329">329</a> #   * &lt;n..&gt;m			=&gt; Location n..m with lt, gt flag</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line330">330</a> # * (J) complement(loc)		=&gt; Sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line331">331</a> # * (K) replace(loc, str)	=&gt; Location with replacement Sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line332">332</a> # </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line333">333</a> class Locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line334">334</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line335">335</a>   include Enumerable</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line336">336</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line337">337</a>   # Parses a GenBank style position string and returns a Bio::Locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line338">338</a>   # object, which contains a list of Bio::Location objects.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line339">339</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line340">340</a>   #   locations = Bio::Locations.new('join(complement(500..550), 600..625)')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line341">341</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line342">342</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line343">343</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line344">344</a>   # * (required) _str_: GenBank style position string</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line345">345</a>   # *Returns*:: Bio::Locations object</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line346">346</a>   def initialize(position)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line347">347</a>     @operator = nil</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line348">348</a>     if position.is_a? Array</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line349">349</a>       @locations = position</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line350">350</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line351">351</a>       position   = gbl_cleanup(position)	# preprocessing</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line352">352</a>       @locations = gbl_pos2loc(position)	# create an Array of Bio::Location objects</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line353">353</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line354">354</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line355">355</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line356">356</a>   # (Array) An Array of Bio::Location objects</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line357">357</a>   attr_accessor :locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line358">358</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line359">359</a>   # (Symbol or nil) Operator.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line360">360</a>   # nil (means :join), :order, or :group (obsolete).</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line361">361</a>   attr_accessor :operator</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line362">362</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line363">363</a>   # Evaluate equality of Bio::Locations object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line364">364</a>   def equals?(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line365">365</a>     if ! other.kind_of?(Bio::Locations)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line366">366</a>       return nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line367">367</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line368">368</a>     if self.sort == other.sort</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line369">369</a>       return true</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line370">370</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line371">371</a>       return false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line372">372</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line373">373</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line374">374</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line375">375</a>   # If _other_ is equal with the self, returns true.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line376">376</a>   # Otherwise, returns false.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line377">377</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line378">378</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line379">379</a>   # * (required) _other_: any object</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line380">380</a>   # *Returns*:: true or false</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line381">381</a>   def ==(other)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line382">382</a>     return true if super(other)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line383">383</a>     return false unless other.instance_of?(self.class)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line384">384</a>     if self.locations == other.locations and</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line385">385</a>         self.operator == other.operator then</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line386">386</a>       true</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line387">387</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line388">388</a>       false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line389">389</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line390">390</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line391">391</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line392">392</a>   # Iterates on each Bio::Location object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line393">393</a>   def each</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line394">394</a>     @locations.each do |x|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line395">395</a>       yield(x)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line396">396</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line397">397</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line398">398</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line399">399</a>   # Returns nth Bio::Location object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line400">400</a>   def [](n)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line401">401</a>     @locations[n]</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line402">402</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line403">403</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line404">404</a>   # Returns first Bio::Location object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line405">405</a>   def first</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line406">406</a>     @locations.first</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line407">407</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line408">408</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line409">409</a>   # Returns last Bio::Location object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line410">410</a>   def last</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line411">411</a>     @locations.last</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line412">412</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line413">413</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line414">414</a>   # Returns an Array containing overall min and max position [min, max]</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line415">415</a>   # of this Bio::Locations object.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line416">416</a>   def span</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line417">417</a>     span_min = @locations.min { |a,b| a.from &lt;=&gt; b.from }</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line418">418</a>     span_max = @locations.max { |a,b| a.to   &lt;=&gt; b.to   }</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line419">419</a>     return span_min.from, span_max.to</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line420">420</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line421">421</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line422">422</a>   # Similar to span, but returns a Range object min..max</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line423">423</a>   def range</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line424">424</a>     min, max = span</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line425">425</a>     min..max</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line426">426</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line427">427</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line428">428</a>   # Returns a length of the spliced RNA.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line429">429</a>   def length</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line430">430</a>     len = 0</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line431">431</a>     @locations.each do |x|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line432">432</a>       if x.sequence</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line433">433</a>         len += x.sequence.size</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line434">434</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line435">435</a>         len += (x.to - x.from + 1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line436">436</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line437">437</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line438">438</a>     len</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line439">439</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line440">440</a>   alias size length</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line441">441</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line442">442</a>   # Converts absolute position in the whole of the DNA sequence to relative </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line443">443</a>   # position in the locus.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line444">444</a>   # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line445">445</a>   # This method can for example be used to relate positions in a DNA-sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line446">446</a>   # with those in RNA. In this use, the optional ':aa'-flag returns the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line447">447</a>   # position of the associated amino-acid rather than the nucleotide.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line448">448</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line449">449</a>   #   loc = Bio::Locations.new('complement(12838..13533)')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line450">450</a>   #   puts loc.relative(13524)        # =&gt; 10</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line451">451</a>   #   puts loc.relative(13506, :aa)   # =&gt; 3</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line452">452</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line453">453</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line454">454</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line455">455</a>   # * (required) _position_: nucleotide position within whole of the sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line456">456</a>   # * _:aa_: flag that lets method return position in aminoacid coordinates</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line457">457</a>   # *Returns*:: position within the location</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line458">458</a>   def relative(n, type = nil)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line459">459</a>     case type</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line460">460</a>     when :location</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line461">461</a>       ;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line462">462</a>     when :aa</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line463">463</a>       if n = abs2rel(n)</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line464">464</a>         (n - 1) / 3 + 1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line465">465</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line466">466</a>         nil</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line467">467</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line468">468</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line469">469</a>       abs2rel(n)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line470">470</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line471">471</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line472">472</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line473">473</a>   # Converts relative position in the locus to position in the whole of the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line474">474</a>   # DNA sequence.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line475">475</a>   # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line476">476</a>   # This method can for example be used to relate positions in a DNA-sequence</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line477">477</a>   # with those in RNA. In this use, the optional ':aa'-flag returns the</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line478">478</a>   # position of the associated amino-acid rather than the nucleotide.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line479">479</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line480">480</a>   #   loc = Bio::Locations.new('complement(12838..13533)')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line481">481</a>   #   puts loc.absolute(10)          # =&gt; 13524</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line482">482</a>   #   puts loc.absolute(10, :aa)     # =&gt; 13506</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line483">483</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line484">484</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line485">485</a>   # *Arguments*:</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line486">486</a>   # * (required) _position_: nucleotide position within locus</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line487">487</a>   # * _:aa_: flag to be used if _position_ is a aminoacid position rather than</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line488">488</a>   #   a nucleotide position</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line489">489</a>   # *Returns*:: position within the whole of the sequence</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line490">490</a>   def absolute(n, type = nil)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line491">491</a>     case type</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line492">492</a>     when :location</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line493">493</a>       ;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line494">494</a>     when :aa</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line495">495</a>       n = (n - 1) * 3 + 1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line496">496</a>       rel2abs(n)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line497">497</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line498">498</a>       rel2abs(n)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line499">499</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line500">500</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line501">501</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line502">502</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line503">503</a>   # String representation.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line504">504</a>   #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line505">505</a>   # Note: In some cases, it fails to detect whether</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line506">506</a>   # &quot;complement(join(...))&quot; or &quot;join(complement(..))&quot;, and whether</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line507">507</a>   # &quot;complement(order(...))&quot; or &quot;order(complement(..))&quot;.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line508">508</a>   # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line509">509</a>   # ---</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line510">510</a>   # *Returns*:: String</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line511">511</a>   def to_s</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line512">512</a>     return '' if @locations.empty?</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line513">513</a>     complement_join = false</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line514">514</a>     locs = @locations</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line515">515</a>     if locs.size &gt;= 2 and locs.inject(true) do |flag, loc|</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line516">516</a>         # check if each location is complement</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line517">517</a>         (flag &amp;&amp; (loc.strand == -1) &amp;&amp; !loc.xref_id)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line518">518</a>       end and locs.inject(locs[0].from) do |pos, loc|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line519">519</a>         if pos then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line520">520</a>           (pos &gt;= loc.from) ? loc.from : false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line521">521</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line522">522</a>           false</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line523">523</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line524">524</a>       end then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line525">525</a>       locs = locs.reverse</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line526">526</a>       complement_join = true</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line527">527</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line528">528</a>     locs = locs.collect do |loc|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line529">529</a>       lt = loc.lt ? '&lt;' : ''</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line530">530</a>       gt = loc.gt ? '&gt;' : ''</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line531">531</a>       str = if loc.from == loc.to then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line532">532</a>               &quot;#{lt}#{gt}#{loc.from.to_i}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line533">533</a>             elsif loc.carat then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line534">534</a>               &quot;#{lt}#{loc.from.to_i}^#{gt}#{loc.to.to_i}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line535">535</a>             else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line536">536</a>               &quot;#{lt}#{loc.from.to_i}..#{gt}#{loc.to.to_i}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line537">537</a>             end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line538">538</a>       if loc.xref_id and !loc.xref_id.empty? then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line539">539</a>         str = &quot;#{loc.xref_id}:#{str}&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line540">540</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line541">541</a>       if loc.strand == -1 and !complement_join then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line542">542</a>         str = &quot;complement(#{str})&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line543">543</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line544">544</a>       if loc.sequence then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line545">545</a>         str = &quot;replace(#{str},\&quot;#{loc.sequence}\&quot;)&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line546">546</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line547">547</a>       str</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line548">548</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line549">549</a>     if locs.size &gt;= 2 then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line550">550</a>       op = (self.operator || 'join').to_s</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line551">551</a>       result = &quot;#{op}(#{locs.join(',')})&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line552">552</a>     else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line553">553</a>       result = locs[0]</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line554">554</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line555">555</a>     if complement_join then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line556">556</a>       result = &quot;complement(#{result})&quot;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line557">557</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line558">558</a>     result</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line559">559</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line560">560</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line561">561</a>   private</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line562">562</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line563">563</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line564">564</a>   # Preprocessing to clean up the position notation.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line565">565</a>   def gbl_cleanup(position)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line566">566</a>     # sometimes position contains white spaces...</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line567">567</a>     position = position.gsub(/\s+/, '')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line568">568</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line569">569</a>     # select one base					# (D) n.m</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line570">570</a>     #               ..         n          m           :</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line571">571</a>     #     &lt;match&gt;   $1       ( $2         $3       not   )</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line572">572</a>     position.gsub!(/(\.{2})?\(?([&lt;&gt;\d]+)\.([&lt;&gt;\d]+)(?!:)\)?/) do |match|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line573">573</a>       if $1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line574">574</a>         $1 + $3						# ..(n.m)  =&gt; ..m</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line575">575</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line576">576</a>         $2						# (?n.m)?  =&gt; n</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line577">577</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line578">578</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line579">579</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line580">580</a>     # select the 1st location				# (E) one-of()</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line581">581</a>     #     &lt;match&gt;   ..      one-of ($2     ,$3      )</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line582">582</a>     position.gsub!(/(\.{2})?one-of\(([^,]+),([^)]+)\)/) do |match|</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line583">583</a>       if $1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line584">584</a>         $1 + $3.gsub(/.*,(.*)/, '\1')			# ..one-of(n,m)  =&gt; ..m</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line585">585</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line586">586</a>         $2						# one-of(n,m)    =&gt; n</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line587">587</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line588">588</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line589">589</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line590">590</a>     ## substitute order(), group() by join()		# (F) group(), order()</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line591">591</a>     #position.gsub!(/(order|group)/, 'join')</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line592">592</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line593">593</a>     return position</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line594">594</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line595">595</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line596">596</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line597">597</a>   # Parse position notation and create Location objects.</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line598">598</a>   def gbl_pos2loc(position)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line599">599</a>     ary = []</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line600">600</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line601">601</a>     case position</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line602">602</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line603">603</a>     when /^(join|order|group)\((.*)\)$/				# (F) join()</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line604">604</a>       if $1 != &quot;join&quot; then</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line605">605</a>         @operator = $1.intern</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line606">606</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line607">607</a>       position = $2</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line608">608</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line609">609</a>       join_list = []		# sub positions to join</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line610">610</a>       bracket   = []		# position with bracket</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line611">611</a>       s_count   = 0		# stack counter</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line612">612</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line613">613</a>       position.split(',').each do |sub_pos|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line614">614</a>         case sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line615">615</a>         when /\(.*\)/</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line616">616</a>           join_list &lt;&lt; sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line617">617</a>         when /\(/</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line618">618</a>           s_count += 1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line619">619</a>           bracket &lt;&lt; sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line620">620</a>         when /\)/</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line621">621</a>           s_count -= 1</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line622">622</a>           bracket &lt;&lt; sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line623">623</a>           if s_count == 0</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line624">624</a>             join_list &lt;&lt; bracket.join(',')</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line625">625</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line626">626</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line627">627</a>           if s_count == 0</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line628">628</a>             join_list &lt;&lt; sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line629">629</a>           else</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line630">630</a>             bracket &lt;&lt; sub_pos</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line631">631</a>           end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line632">632</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line633">633</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line634">634</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line635">635</a>       join_list.each do |position|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line636">636</a>         ary &lt;&lt; gbl_pos2loc(position)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line637">637</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line638">638</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line639">639</a>     when /^complement\((.*)\)$/				# (J) complement()</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line640">640</a>       position =       $1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line641">641</a>       gbl_pos2loc(position).reverse_each do |location|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line642">642</a>         ary &lt;&lt; location.complement</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line643">643</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line644">644</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line645">645</a>     when /^replace\(([^,]+),&quot;?([^&quot;]*)&quot;?\)/		# (K) replace()</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line646">646</a>       position =    $1</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line647">647</a>       sequence =              $2</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line648">648</a>       ary &lt;&lt; gbl_pos2loc(position).first.replace(sequence)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line649">649</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line650">650</a>     else						# (A, B, C, G, H, I)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line651">651</a>       ary &lt;&lt; Location.new(position)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line652">652</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line653">653</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line654">654</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line655">655</a>     return ary.flatten</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line656">656</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line657">657</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line658">658</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line659">659</a>   # Convert the relative position to the absolute position</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line660">660</a>   def rel2abs(n) </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line661">661</a>     return nil unless n &gt; 0			# out of range </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line662">662</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line663">663</a>     cursor = 0 </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line664">664</a>     @locations.each do |x|      </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line665">665</a>       if x.sequence </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line666">666</a>         len = x.sequence.size </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line667">667</a>       else </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line668">668</a>         len = x.to - x.from + 1 </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line669">669</a>       end  </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line670">670</a>       if n &gt; cursor + len </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line671">671</a>         cursor += len </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line672">672</a>       else </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line673">673</a>         if x.strand &lt; 0 </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line674">674</a>           return x.to - (n - cursor - 1) </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line675">675</a>         else </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line676">676</a>           return x.from + (n - cursor - 1) </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line677">677</a>         end </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line678">678</a>       end                             </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line679">679</a>     end </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line680">680</a>     return nil					# out of range </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line681">681</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line682">682</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line683">683</a>   # Convert the absolute position to the relative position</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line684">684</a>   def abs2rel(n)</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line685">685</a>     return nil unless n &gt; 0			# out of range</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line686">686</a> </pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line687">687</a>     cursor = 0</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line688">688</a>     @locations.each do |x|</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line689">689</a>       if x.sequence</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line690">690</a>         len = x.sequence.size</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line691">691</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line692">692</a>         len = x.to - x.from + 1</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line693">693</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line694">694</a>       if n &lt; x.from or n &gt; x.to then</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line695">695</a>         cursor += len</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line696">696</a>       else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line697">697</a>         if x.strand &lt; 0 then</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line698">698</a>           return x.to - (n - cursor - 1)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line699">699</a>         else</pre></td>
          </tr>
        
          
          
          <tr class="marked">
            <td><pre><a name="line700">700</a>           return n + cursor + 1 - x.from</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line701">701</a>         end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line702">702</a>       end</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line703">703</a>     end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line704">704</a>     return nil					# out of range</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line705">705</a>   end</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line706">706</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line707">707</a> end # Locations</pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line708">708</a> </pre></td>
          </tr>
        
          
          
          <tr class="uncovered">
            <td><pre><a name="line709">709</a> end # Bio</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line710">710</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line711">711</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line712">712</a> </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line713">713</a> # === GenBank location examples</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line714">714</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line715">715</a> # (C) n^m</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line716">716</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line717">717</a> # * [AB015179]	754^755</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line718">718</a> # * [AF179299]	complement(53^54)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line719">719</a> # * [CELXOL1ES]	replace(4480^4481,&quot;&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line720">720</a> # * [ECOUW87]	replace(4792^4793,&quot;a&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line721">721</a> # * [APLPCII]	replace(1905^1906,&quot;acaaagacaccgccctacgcc&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line722">722</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line723">723</a> # (D) (n.m)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line724">724</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line725">725</a> # * [HACSODA]	157..(800.806)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line726">726</a> # * [HALSODB]	(67.68)..(699.703)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line727">727</a> # * [AP001918]	(45934.45974)..46135</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line728">728</a> # * [BACSPOJ]	&lt;180..(731.761)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line729">729</a> # * [BBU17998]	(88.89)..&gt;1122</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line730">730</a> # * [ECHTGA]	complement((1700.1708)..(1715.1721))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line731">731</a> # * [ECPAP17]	complement(&lt;22..(255.275))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line732">732</a> # * [LPATOVGNS]	complement((64.74)..1525)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line733">733</a> # * [PIP404CG]	join((8298.8300)..10206,1..855)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line734">734</a> # * [BOVMHDQBY4]	join(M30006.1:(392.467)..575,M30005.1:415..681,M30004.1:129..410,M30004.1:907..1017,521..534)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line735">735</a> # * [HUMMIC2A]	replace((651.655)..(651.655),&quot;&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line736">736</a> # * [HUMSOD102]	order(L44135.1:(454.445)..&gt;538,&lt;1..181)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line737">737</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line738">738</a> # (E) one-of</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line739">739</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line740">740</a> # * [ECU17136]	one-of(898,900)..983</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line741">741</a> # * [CELCYT1A]	one-of(5971..6308,5971..6309)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line742">742</a> # * [DMU17742]	8050..one-of(10731,10758,10905,11242)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line743">743</a> # * [PFU27807]	one-of(623,627,632)..one-of(628,633,637)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line744">744</a> # * [BTBAINH1]	one-of(845,953,963,1078,1104)..1354</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line745">745</a> # * [ATU39449]	join(one-of(969..1094,970..1094,995..1094,1018..1094),1518..1587,1726..2119,2220..2833,2945..3215)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line746">746</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line747">747</a> # (F) join, order, group</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line748">748</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line749">749</a> # * [AB037374S2]	join(AB037374.1:1..177,1..807)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line750">750</a> # * [AP000001]	join(complement(1..61),complement(AP000007.1:252907..253505))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line751">751</a> # * [ASNOS11]	join(AF130124.1:&lt;2563..2964,AF130125.1:21..157,AF130126.1:12..174,AF130127.1:21..112,AF130128.1:21..162,AF130128.1:281..595,AF130128.1:661..842,AF130128.1:916..1030,AF130129.1:21..115,AF130130.1:21..165,AF130131.1:21..125,AF130132.1:21..428,AF130132.1:492..746,AF130133.1:21..168,AF130133.1:232..401,AF130133.1:475..906,AF130133.1:970..1107,AF130133.1:1176..1367,21..&gt;128)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line752">752</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line753">753</a> # * [AARPOB2]	order(AF194507.1:&lt;1..510,1..&gt;871)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line754">754</a> # * [AF006691]	order(912..1918,20410..21416)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line755">755</a> # * [AF024666]	order(complement(18919..19224),complement(13965..14892))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line756">756</a> # * [AF264948]	order(27066..27076,27089..27099,27283..27314,27330..27352)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line757">757</a> # * [D63363]	order(3..26,complement(964..987))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line758">758</a> # * [ECOCURLI2]	order(complement(1009..&gt;1260),complement(AF081827.1:&lt;1..177))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line759">759</a> # * [S72388S2]	order(join(S72388.1:757..911,S72388.1:609..1542),1..&gt;139)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line760">760</a> # * [HEYRRE07]	order(complement(1..38),complement(M82666.1:1..140),complement(M82665.1:1..176),complement(M82664.1:1..215),complement(M82663.1:1..185),complement(M82662.1:1..49),complement(M82661.1:1..133))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line761">761</a> # * [COL11A1G34]	order(AF101079.1:558..1307,AF101080.1:1..749,AF101081.1:1..898,AF101082.1:1..486,AF101083.1:1..942,AF101084.1:1..1734,AF101085.1:1..2385,AF101086.1:1..1813,AF101087.1:1..2287,AF101088.1:1..1073,AF101089.1:1..989,AF101090.1:1..5017,AF101091.1:1..3401,AF101092.1:1..1225,AF101093.1:1..1072,AF101094.1:1..989,AF101095.1:1..1669,AF101096.1:1..918,AF101097.1:1..1114,AF101098.1:1..1074,AF101099.1:1..1709,AF101100.1:1..986,AF101101.1:1..1934,AF101102.1:1..1699,AF101103.1:1..940,AF101104.1:1..2330,AF101105.1:1..4467,AF101106.1:1..1876,AF101107.1:1..2465,AF101108.1:1..1150,AF101109.1:1..1170,AF101110.1:1..1158,AF101111.1:1..1193,1..611)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line762">762</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line763">763</a> # group() are found in the COMMENT field only (in GenBank 122.0)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line764">764</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line765">765</a> #   gbpat2.seq:            FT   repeat_region   group(598..606,611..619)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line766">766</a> #   gbpat2.seq:            FT   repeat_region   group(8..16,1457..1464).</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line767">767</a> #   gbpat2.seq:            FT   variation       group(t1,t2)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line768">768</a> #   gbpat2.seq:            FT   variation       group(t1,t3)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line769">769</a> #   gbpat2.seq:            FT   variation       group(t1,t2,t3)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line770">770</a> #   gbpat2.seq:            FT   repeat_region   group(11..202,203..394)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line771">771</a> #   gbpri9.seq:COMMENT     Residues reported = 'group(1..2145);'.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line772">772</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line773">773</a> # (G) ID:location</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line774">774</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line775">775</a> # * [AARPOB2]	order(AF194507.1:&lt;1..510,1..&gt;871)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line776">776</a> # * [AF178221S4]	join(AF178221.1:&lt;1..60,AF178222.1:1..63,AF178223.1:1..42,1..&gt;90)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line777">777</a> # * [BOVMHDQBY4]	join(M30006.1:(392.467)..575,M30005.1:415..681,M30004.1:129..410,M30004.1:907..1017,521..534)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line778">778</a> # * [HUMSOD102]	order(L44135.1:(454.445)..&gt;538,&lt;1..181)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line779">779</a> # * [SL16SRRN1]	order(&lt;1..&gt;267,X67092.1:&lt;1..&gt;249,X67093.1:&lt;1..&gt;233)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line780">780</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line781">781</a> # (I) &lt;, &gt;</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line782">782</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line783">783</a> # * [A5U48871]	&lt;1..&gt;318</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line784">784</a> # * [AA23SRRNP]	&lt;1..388</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line785">785</a> # * [AA23SRRNP]	503..&gt;1010</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line786">786</a> # * [AAM5961]	complement(&lt;1..229)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line787">787</a> # * [AAM5961]	complement(5231..&gt;5598)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line788">788</a> # * [AF043934]	join(&lt;1,60..99,161..241,302..370,436..594,676..887,993..1141,1209..1329,1387..1559,1626..1646,1708..&gt;1843)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line789">789</a> # * [BACSPOJ]	&lt;180..(731.761)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line790">790</a> # * [BBU17998]	(88.89)..&gt;1122</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line791">791</a> # * [AARPOB2]	order(AF194507.1:&lt;1..510,1..&gt;871)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line792">792</a> # * [SL16SRRN1]	order(&lt;1..&gt;267,X67092.1:&lt;1..&gt;249,X67093.1:&lt;1..&gt;233)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line793">793</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line794">794</a> # (J) complement</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line795">795</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line796">796</a> # * [AF179299]	complement(53^54)	&lt;= hoge insertion site etc.</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line797">797</a> # * [AP000001]	join(complement(1..61),complement(AP000007.1:252907..253505))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line798">798</a> # * [AF209868S2]	order(complement(1..&gt;308),complement(AF209868.1:75..336))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line799">799</a> # * [AP000001]	join(complement(1..61),complement(AP000007.1:252907..253505))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line800">800</a> # * [CPPLCG]	complement(&lt;1..(1093.1098))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line801">801</a> # * [D63363]	order(3..26,complement(964..987))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line802">802</a> # * [ECHTGA]	complement((1700.1708)..(1715.1721))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line803">803</a> # * [ECOUXW]	order(complement(1658..1663),complement(1636..1641))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line804">804</a> # * [LPATOVGNS]	complement((64.74)..1525)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line805">805</a> # * [AF129075]	complement(join(71606..71829,75327..75446,76039..76203,76282..76353,76914..77029,77114..77201,77276..77342,78138..78316,79755..79892,81501..81562,81676..81856,82341..82490,84208..84287,85032..85122,88316..88403))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line806">806</a> # * [ZFDYST2]	join(AF137145.1:&lt;1..18,complement(&lt;1..99))</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line807">807</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line808">808</a> # (K) replace</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line809">809</a> # </pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line810">810</a> # * [CSU27710]	replace(64,&quot;A&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line811">811</a> # * [CELXOL1ES]	replace(5256,&quot;t&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line812">812</a> # * [ANICPC]	replace(1..468,&quot;&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line813">813</a> # * [CSU27710]	replace(67..68,&quot;GC&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line814">814</a> # * [CELXOL1ES]	replace(4480^4481,&quot;&quot;)	&lt;= ? only one case in GenBank 122.0</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line815">815</a> # * [ECOUW87]	replace(4792^4793,&quot;a&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line816">816</a> # * [CEU34893]	replace(1..22,&quot;ggttttaacccagttactcaag&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line817">817</a> # * [APLPCII]	replace(1905^1906,&quot;acaaagacaccgccctacgcc&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line818">818</a> # * [MBDR3S1]	replace(1400..&gt;9281,&quot;&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line819">819</a> # * [HUMMHDPB1F]	replace(complement(36..37),&quot;ttc&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line820">820</a> # * [HUMMIC2A]	replace((651.655)..(651.655),&quot;&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line821">821</a> # * [LEIMDRPGP]	replace(1..1554,&quot;L01572&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line822">822</a> # * [TRBND3]	replace(376..395,&quot;atttgtgtgtggtaatta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line823">823</a> # * [TRBND3]	replace(376..395,&quot;atttgtgtgggtaatttta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line824">824</a> # * [TRBND3]	replace(376..395,&quot;attttgttgttgttttgttttgaatta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line825">825</a> # * [TRBND3]	replace(376..395,&quot;atgtgtggtgaatta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line826">826</a> # * [TRBND3]	replace(376..395,&quot;atgtgtgtggtaatta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line827">827</a> # * [TRBND3]	replace(376..395,&quot;gatttgttgtggtaatttta&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line828">828</a> # * [MSU09460]	replace(193,		&lt;= replace(193, &quot;t&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line829">829</a> # * [HUMMAGE12X]	replace(3002..3003,	&lt;= replace(3002..3003, &quot;GC&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line830">830</a> # * [ADR40FIB]	replace(510..520,	&lt;= replace(510..520, &quot;taatcctaccg&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line831">831</a> # * [RATDYIIAAB]	replace(1306..1443,&quot;aagaacatccacggagtcagaactgggctcttcacgccggatttggcgttcgaggccattgtgaaaaagcaggcaatgcaccagcaagctcagttcctacccctgcgtggacctggttatccaggagctaatcagtacagttaggtggtcaagctgaaagagccctgtctgaaa&quot;)</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line832">832</a> #</pre></td>
          </tr>
        
          
          
          <tr class="inferred">
            <td><pre><a name="line833">833</a> </pre></td>
          </tr>
        
      </tbody>
    </table>

    <p>Generated on Sun Jun 27 22:28:56 +0900 2010 with <a href="http://github.com/relevance/rcov">rcov 0.9.8</a></p>

  </body>
</html>
