#
# test/unit/bio/*****.rb - Unit test for Bio::Phylip::PhylipFormat
#
# Copyright::  Copyright (C) 2009 Naohisa Goto <ng@bioruby.org>
# License::    The Ruby License
#

# loading helper routine for testing bioruby
require 'pathname'
load Pathname.new(File.join(File.dirname(__FILE__), ['..'] * 4,
                            'bioruby_test_helper.rb')).cleanpath.to_s

# libraries needed for the tests
require 'test/unit'
require 'bio/alignment'
require 'lib/bio/appl/phylip/alignment.rb'

module Bio
  class TestBioPhylipPhylipFormat < Test::Unit::TestCase


#This tests a file of interleaved type. I don't know non-interleaved type.
    def setup
      filename = File.join(BioRubyTestDataPath, 'phylip/sample_interleaved.phy')
      @obj = Bio::Phylip::PhylipFormat.new(File.read(filename))
    end


   def test_alignment
      expected =  {
 :keys=>["gi|3006781", "gi|3006780", "gi|6801282", "gi|6802245"],
 :seqs=>
  {"gi|6802245"=>
    "-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ATGACTATAGATTTAAATGTTATACAAAGTGACATTATCTCAGCGCGTCGAGCTCCTGAAAATAGTCTGTTTATAGATGGGAAATTCGTTTCTCCTATCGAGCCAGCTGCGAAGCCCATCCCTTTAATC--AATCCAGCAACTGA---GGAGATTATTGGCACTTGTGCAAATGCTTCTGCCAAAGATGTCGATTCAGCTGTGGAGAATGCTTACAACACTTTTCGTTCTGGAATATGGGCCAAATGGCCTGGCAAACAACGTGGGTTGGTTTTGAGAAAGATA-GCTAAAATGA----TGAGAGAAAAGCGTGAACTTCTTGCTGGAATAGATACTATTAACTGTGGAAAGCCAACCCCATACGCATTGTTCGAT---ATAGATAGCTGCGCAGACATGTTTGAGTATTATGCTGAAGTGGC----------AGAAACCGACAACCCTACAGTTAAGGTTCCCTTACCTAACAATCCAGGATTTTGCGCATTTGAAA--AACGTTTTCCTAGAGGT-GTCATCGGTGTCATTACTCCATGGAATTTCCCTCTGAAAATGGCTTTAT-GGAAGCTGGTTCCAG-CTATTGCAAGCGGTAATTGCGTAGTTTTAAAACCTTCAGAGTTAGCCCCATGGTCATGCCTTGAATTCGCACTGATTTGCAAGGAAGCGGGTTTGCCCGATGGTGTTTTGAATGTTATCATTGGATCTGGTAAAGAGTCGGGAGCTGCACTTAGCTGTCATCCTAAGATTGCCTATCTAGCATTTACAGGATCCTTGGCTACCGGAAAAAAGATTATGCATGCTGCTGCTGAAAATATTGTCCCGTTAACCCTTGAACTTGGGGGTAAGTCACCTCTAA----TAATTTGTGAAGATGCGGATCTTTCTCTCGCTATTCCTTCTGCAGCCTTTGCTATTTTCTTTAAT-CAAGGTGA-AGCCTGTACTGCGGCTTCTCGTTTGATCGTTCATGAAAGTGTTGCGGATGAAGTACTTGGCGGCTTAGTGAGTGA---AGCTAATAAACTAATAATTGGAAATGGATTGGAT-CCTCAAGTAACCT------TGGGCCCTGTAGTGAGCAAAACCCAGTTTGAAAAAATTG--TTAGCTACATTCAAT-CAGCTATAAATGAAGGATG-TAAATGTGTAGTAGGTGG-ACTTCCCAGATCTGAA----CAAAAAGGTTATTTTATTCCACCCACCGTATTTACGAATGTGCAAACTCACAACAAGATTTGGAGAGAGGAAATCTTTGGGCCTGTCTTAGCTGTGAAGACATTCCATACAAATGAGGAAGCATTGG--AGTTGGCTAATGACTCTGAATATGGACTTGGTTCCGGTGTTTTTTCTACAAATCCTAAAACCC-TTGAATTTTTCAGCA-ATAACATTG-AGGCAGGTATG-----TGCTCAT----TAAATAACTATCATGTTGTTACACACGAGCTTCCATGGATTGGATGGAAGCACTCTGGATTAGGTGTTGGCTTATCTAAGCACGGCTACAATGAGTACATGCGTCT---CAAACAAATCACTCAGTATGTTGGCTAA--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",
   "gi|6801282"=>
    "---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ATGTCCTCTACGTTGACATGCTATTGTCCAGGAGACGGGTCGT-------TGCTTG--GAGAAGTCAAGCTATTCAACA--AGTCTGATAT-TGA---TCAGTCAATCATCTTGGCTGAAGAAGCCCA--AAAAGAATGGAAATCTACTT-----CATTTGCTGAAAGGCGCAATTTTT------------TGAAGGCTTTGAAGGAAAACATTATTAGAAACCAAGATAAATATGCAGAAATTGCC--TGCAAAGATACCGGTAA-----AACATTGGTAGATGCCGCGTTCGGTGAAATATTGGTTACATTAGAAAAAATTAACTGGACGCTTGCTAATGGAGAGCAGTCTTTGCGTCCTAC-GAAACGTCC-------TAACTCGTTGTTAACTTCATA-TAAAGGAG--GTTAT--GTTAAATATGAG------CCATTGGGAGTTATAGCTGCATTAG--TTAGTTGGAACTATCCTCTTCACAATGCCTTGGGTCC-TATCATTTCTGCATTGTTTGCTGGAAACG--CTATTGTTGTGAAGGGAAGCG--AGCTTACAGCGT--GGTCTACACATCAATATTGTGAAATG-GTTCGTAGTTTATTACAATCAATGGGCCATTCCCCTGAACTCGTTCAATGT----ATTACTTGTCTACCAGATGTTGCTGATCACCTTACCAGTCACTCTGGAATTAAGCATATAACTTTCATTGGTTCTCAGCCTATCGCAAAATTGGTTGCTGCTTCTGCTGCAAAACAACTTACTCCCTTGTGCCTTGAATTAGGAGGAAAAGATCCT-TGTATTTTAACTGACGACCACA---GACTAGAAGAGATCTTGTCTATAGTTATGCGAGGTGTTTTCCAAAGTGCCGGACAA--AATTGTATTGGTATTGAGCGTATCATTGCTTTGGATGGCGTTTACGACACCATAATTACGAAATTATACAACAG---AATTTCCACTATGAG------ACTTGGCATGTACACCCAAAATGATGTCGATA-TGGGTGCTATGGTATCTAATAATCGATTTGATCATTTAGAATCTTTAATACAGGATGCTGTTAGCAAAGGAGCTCGTTTAGTGTACGGTGGTCACCGTTTTCAACATCCTAAGTATCCTAAAGGAAATTATTTTTTACCCACTTTGCTTGTTGATGCTACTAATGAGATGAAGATTGCCCAAGAAGAGTGCTTTGCTCCAATTGCACTTGTTTTTCGAGCAAAATCACCCGAACATGCTTTAG--AGATTGCTAACGGTACTGAATTTGGGTTGGGGGCATCCGTGTTTGGCCGGGATAAGCAATTAT-GTCAATATTTCACTG-ATAATTTGG-AAACCGGTATGGTTGCTGTTAATGATTTTGGTGCCTTTTATT-TGCTACAAATGCCTTTTGGTGG-TTGCAAGAAAA-GTGGTTATGGAAGATTTGCCGGATATGAGGGT--CTACG-CGGA-ATCTGCAATT--CCAAGGCTATTGCTTACGAT--CGATTTAGTGC-CATCCATACTGGCATTCCCCCTGCTGTTGACTATC------CTATTC-CCGATTCTCAAAAGGC--TTGGCAATTTGTTCGCGGTCTTATGGGAACTGTGTATGGC-GCTTGGATCAGTCTTGTTCCTAATGTTTACCAATTATGGCGTAACTCTTAA-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------",
   "gi|3006780"=>
    "CACCGAGCCGAGCCACTTAGCGAGGGAGCAGCCTCCACCTCCACCTCCACGGCGACGAGAGAATGGGGAGAGGAG--GGATCGGAGGCGCGGTGGGCATGGCCATGGAGAACGCCGATTCCGCCCGCGCATTCGTCAAGGACGTCAAGCGAATCATTATCAAGGTGGGCACAGCTGTTGTCACTGGGCAGAATGGCCGATTGGCAATGGGCGGGCTCGGTTCTCTCTGTGAACAGGTGAAGCAACTGAATTTTCAAGGGTATGAGGTGATTCTGGTAACCTCAGGAGCTGTTGGTGTTGGGAGGCAGAGGCTCCAATACCGTAAGCTTATCCATAGCAGCTTTGCAGATCTGCAAAATCCTCAGATGAACTTTGATGGAAAGGCCTGTGCTGCTGTGGGTCAAAGTGGCCTGATGGCTATCTGTGACACATTATTTAGCCAACTTGATGTAACATCATCTCAACTTCTTGTAACGGATCGTGATTTCAGGGATCCAAGTTTTGGGGACCAGCTCCGCGAGACTGTTTTTGCACTATTAAATCTTAAAGTAATACCGTTATTTAATGAGAATGATGCCATCAGTACCCGGAGACAATCAGATGAGGATTCATCTGGTGTATTCTGGGATAATGACAGTCTAGCAGCTCTGTTGGCAGCCGAACTTAATGCTGATCTTCTTATCATGCTTA--GTGATGTGGAGGGACTCTATAGTGGTCCACCAAGCGATCCTCAGTCAAAGACTATCCACACATATGTCAATGAAAAGCATGGGAAGCTAATTA----GTTTTGGAGAGAAGTCTAATGTTGGAAGAGGTGGCATGCAAGCTAAAGTGGCTGCTGCTGCTAATGCTGCATCAAAAGGTGTACCAGTTGTCATTGCAAGTGGATTTGCAACGGATAGCATCATTAAAGTTCTCAAAGGAGAAAAGATTGGTACACTTTTCCACAATGAAGCAAATTTGTGGGAATGTTCCAAGGAAGCTACAGCCCGA-GAGATGGCAGTTGCGGCAAGAGACTGTTCGAGACGTC-TACAGAAGTTGTCACCAGATGAACGCAAAAAGATTTTGCTAGATATTGCTGATGCTCTGGAAGCAAATGAGGGTGCAATTAGGTCTGAAAATGAAGCCGATGTTGAGGCAGCACAAGGTGCTGGTTATGAAAAGTCGTTGGTTGCTAGGATG--ACCCTAAAGCCA--GGAAAGATAACAAACCTTGCAAGATCCATTCGTGCCATTGCTGACATGGAGGACCCTATTTCCCATACATTGAAAAGA----ACAGAGGTTGCTAAAGATCTGGTTTTTGAGAAAGCATATTGCCCATTGGGTGTTCTGCTCATTATTTTTGAGTCTCGTCCTGATGCATTGGTCCAGATTGCATCTCTGGCAATCCGAAGTGGTAATGGTCTTCTTTTGAAAGGAGGAAAAGAAGCTATGCGATCAAACGCAATATTACACAAGGTCATAACTGGGGTTATTCCAGATATTGTTGGTAAAAAGCTCATAGGCCATGTGACTAGCAAAGATGAAATTGCTGATTTGCTAGCGCTTGATGATGTGATTGATCTTGTCATTCCTAGAGGCAGCAAGAATCTAGTCTCCCAAATCAAAGCAACAACTAAGATTCCAGTTTTAGGTCATGCTGGTGGTATCTGCCATG-TTTATATTGACAAATCAGCCGACATGGATATGGCAAAAC-GGATAGTATTGGGCGCCAAGGTTGATTATCCAGCAGCATGTAATGCAATGGAAACACTACTTGTTCATAAAGATCTTAACAAGAGTGAGGGC--CTTGATGAT-CTATTAGTGGAAC-----TTGAAAAGGAAGGAGTAGTTATTTATGGTGGGCCTGTT----GCACATGACAAATTGAAAGTACCAAAGGTAGATTCATTTCGCCA-TGAGTATAGCTCAATGGCATGCACTCTCGAATTTGTTGATGATGTGCAGTCAGCTATCGATCACATAAATCGTTATGGAAGTGCACACACAGACTGCATCATCACAACTGATGAAAGTGCTGCGGAGGCTTTTCTGCAG-CAAGTCGATAGTGCTGCTGTGTTTCATAATGCAAGCACAAGGTT--TTGTGATGGG-ACACGCTTTGGGCTAGGTGCAGAGGTTGGCAT--AAGTACAGGGCGCATACATGCCCGCGGACCTGTCGGAGTTGATGGACTTCTAACTACTCGCTGCATTTTACGCGGTAGTGGACAAGTGGTGAATGGTGACAAGGGAGTGGTTTACACCCACAAGGATCTTCCTTTGCAATGAGGCAAAGAACCTCTGTTGTAGAACAATTGCTCTCGTAACGAATGGCTGAACTCCCCTTTAAGTACCCTTTTCCTTTTTTCCATGCAACAAAGACAGGTG--TCGTAACAAGCAGAAGGAACTGATACTCTCTCTGCGGTGCCTATTTAT----TAGACAATGATGTATTCAGACCATTTTGGTACGAGGCTTGTAAGCTGTGTTTGTCCTGTTATTGTCGTATAAGCTCTAGAACTTCCGAGACATCTGTATTAGAGGCGTAGTAGCTGGTTGAATGCGATGGTTTTGGATGAAACTCGAATCTGTTCCCGTGCAATTATAATGCATGTGTGATGAGATCC",
   "gi|3006781"=>
    "----------------------------------------------------AGACG-GAGGACCAGGAGCGGCGTCGAACTAAAAGCGCCGGCGGC--GGTCATGGCCACCGCGGACCGGACCCGGTCTTTCATGAGGGATGTTAAACGCGTCATCATCAAGGTGGGCACTGCAGTTGTCACGAGGCATGATGGGCGACTAGCTCTGGGTAGATTAGGGGCTCTTTGTGAGCAGGTGAAGGAGCTGAACGCCCTAGGATACGAGGTGATCATTGTGACCTCAGGTGCTGTTGGTGTGGGGAAGCAGAGGCTTAAGTACAGGAAGCTTGTCAATAGCAGCTTTGCTGATCTGCAAAAGCCACAGATGGAGCTGGATGGAAAGGCCTGTGCTGCCGTTGGACAGAGTGGCCTCATGGCTCTTTACGATATGCTATTTACTCAACTTGATGTATCCTCTTCCCAGCTTCTTGTGACAGACAGTGATTTTGAGAATCCAAACTTCCGGGAGAGGCTCCGTGAAACTGTTGAGTCACTATTAGATCTTAAAGTTGTACCAATATTTAATGAGAATGATGCCATCAGCACTAGAAAGGCTCCATATGAGGATTCATCTGGTATATTTTGGGATAACGATAGTTTAGCCGGTCTTCTGGCTATAGAACTCAAAGCAGATCTTCTTGTTCTACTCA--GTGACGTGGATGGCCTCTATAGTGGTCCACCAAGTGAACCTCAATCAAAGATAATACATACCTACATCAAAGAAAAACATCACAATGAAATTA----CTTTTGGGGATAAGTCACGTGTACGTAGAGGAGGAATGACAGCTAAAGTGAAGGCTGCTTTCGTGGCTTCAAACAGTGGCACACCTGTTGTTATTACAAG---ATTTGCGTCTCAGAGCATTGTTAGAGTTCTCCAAGGAGAGAAAATTGGTACTCTCTTTCATAAGGATGCAAGTTTGTGGGAACCATCCAAAGATGTTAGTGCTCGT-GAGATGGCCCTTGGTGCAAGGGAGTCTTCAAGGCGTT-TGCAGAATTTGTCATCTGATGAGCGCAAGAAAATATTGTTGGACGTTGCAGATGCCTTGGAAGAGAATGTGGATTTAATTAGAACTGAGAATGAAATAGATGTATCTGCAGCACAAGAGGCAGGATATGAACCATCTTTGGTTGCGAGATTG--ACTTTGAAGCCA--GGAAAGATAGCAAGCCTTGCGAAATCCATTCGCACTCTTGCATATATGGAAGACCCAATCAATCAGATAATTAAAAGA----ACAGAGGTTGCTGAAGATCTGGTTCTCGAAAAAACATCTTGTCCTCTAGGTGTGCTATTGATCGTTTTTGAGTCCAGGCCTGATGCCTTGGTCCAGATTGCGTCTTTAGCAATCCGAAGTGGCAACGGTCTTCTCCTGAAAGGTGGAAAAGAAGCCATGAGGTCAAACACAATACTGCATAAGGTTATAACTAGTGCAATTCCTAGCAACGTGGGTGAAAAACTTATTGGCCTTGTTACAAGTAGAGATGAAATCGCTGATTTACTAAAGCTTGATGATGTGATTGATCTTGTCATTCCAAGAGGCAGCAATAAGCTGGTGTCGCAAATCAAGTCATCAACTAAGATCCCTGTCCTTGGTCATGCTGATGGTATCTGTCATG-TATACATCGACAAATCAGCTGACATGAATATGGCAAAAC-GAATAGTGCTGGACGCTAAAATTGATCACCCAGCAGCCTGCAATGCTATGGAGACATTGCTTGTTCATAAAGATCTCATAAATGCTCCAGGT--CTTGATGAC-CTACTGCTAGCAC-----TCAAAACAGAAGGAGTTGCTATTTATGGAGGGCCTGTT----GCACATGAACTATTGTGCATTCCAAAAGCAGATTCATTACATCA-TGAATATAGCTCTATGGCCTGCACAATTGAATTCGTTGATGATGTACAGTCAGCAATTGACCATATACATCGTTACGGAAGTGCACATACAGATTGCATTGTTACTACAGATGATAAAGTAGCAGAAACTTTTTTGCGT-CAAGTTGATAGTGTTGCTGTATTTTATAATGCGAGCACACGATT--CTCTGATGGG-GCTCGTTTTGGATTGGGTGCTGAGGTTGGCAT--AAGCACAGGGCGCATACATGCTCGCGGACCTGTGGGTGTTGAAGGTCTCTTAACAACACGCTGGATCATGCGAGGGAGTGGGCAAGTGGTGAACGGTGACAAGGATATTGCATACACCCATAAGAACCTTCCTTTGCAATGAGGCAGGGCATTTTTGTGCTTAATCA---GGATTCGTGTCGATCCAGTGA---------TGTATGATAGTTTCATCAGATA---GGAGCAGAGAATGGTGAATCTTTTCGATTGAGGACTGTGAATCCATGGACTGCAATGTTCAGTCAGTGTGTAGACCATCATTCTGGTGGTTCATTCTG----------------------------------------------------------------------------------------------------------------------------------------------------------------"}}

      al = @obj.alignment
      seqs = {}
      al.each_pair{|k, seq| seqs[k] = seq }
      actual =
      {
        :keys=> al.keys,
        :seqs=> seqs
      }
      assert_equal(expected, actual)
    end

  end #class TestBioPhylipPhylipFormat
end #module Bio

